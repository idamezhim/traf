<script type="text/javascript" src="https://www.youtube.com/iframe_api"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/TweenMax.min.js"></script>
<script>

  // Youtube audio
  var player;
  function onYouTubeIframeAPIReady() {
    var ctrlq = document.getElementById("youtube-audio");
    ctrlq.innerHTML = '<img id="youtube-icon" src=""/><div id="youtube-player"></div>';
    ctrlq.onclick = toggleAudio;
    player = new YT.Player('youtube-player', {
      height: '0',
      width: '0',
      videoId: ctrlq.dataset.video,
      playerVars: { autoplay: ctrlq.dataset.autoplay, loop: ctrlq.dataset.loop, },
      events: { 'onReady': onPlayerReady, 'onStateChange': onPlayerStateChange }
    });
  }
  function togglePlayButton(play) {
    document.getElementById("youtube-icon").src = play ? "/images/icon-pause.png" : "/images/icon-play.png";
  }
  function toggleAudio() {
    if ( player.getPlayerState() == 1 || player.getPlayerState() == 3 ) {
      player.pauseVideo();
      togglePlayButton(false);
    } else {
      player.playVideo();
      togglePlayButton(true);
    }
  }
  function onPlayerReady(event) {
    player.setPlaybackQuality("small");
    document.getElementById("youtube-audio").style.display = "block";
    togglePlayButton(player.getPlayerState() !== 5);
  }
  function onPlayerStateChange(event) {
    if (event.data === 0) {
      togglePlayButton(false);
    }
  }

  // Music bar by Bruno Torrinha
  var bars = $('.music-bar .bar');
    var tl = (new TimelineMax()).staggerTo(bars, .4, {
      y: -10,
      repeat: -1,
      paused: false,
      yoyo: true,
      ease: Quad.easeInOut}, .25
    ).pause();
    $('.music-player').on('click', function(){
      tl.isActive() ? pause() : tl.play();
    });
    function pause() {
      tl.pause();
      TweenMax.to(bars, .7, {
        y: 0,
        ease: Quad.easeOut}
      );
    }

    // Adblocking
    // var adBlockEnabled = false;
    // var testAd = document.createElement('div');
    // testAd.innerHTML = '&nbsp;';
    // testAd.className = 'adsbox';
    // document.body.appendChild(testAd);
    // window.setTimeout(function() {
    //   if (testAd.offsetHeight === 0) {
    //     adBlockEnabled = true;
    //   }
    //   testAd.remove();
    //   console.log('AdBlock Enabled? ', adBlockEnabled)
    // }, 100);
    function appendMessage(argument) {
      var div = $('<div>').attr('id', 'message').text('Ad block is installed and active. Please support us by disabling it.');
      var add = $('body').append(div);
    }
    setTimeout(function(){
      if($("img").css('display') == "none") {
        appendMessage();
      }
    }, 500);

</script>